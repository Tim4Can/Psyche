{"remainingRequest":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\src\\views\\sheets\\workSheet.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\src\\views\\sheets\\workSheet.vue","mtime":1562869728000},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1573725483614},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Fuse from 'fuse.js'\nimport Vue from 'vue'\nimport Lightbox from 'vue-easy-lightbox'\nimport { PageView } from '@/layouts'\n\n\nVue.use(Lightbox)\nimport { getWorkSheet, deleteWorkSheetRow } from '@/api/sheets'\n\n\nconst statusMap = {\n  0: {\n    status: 'processing',\n    text: '进行'\n  },\n  1: {\n    status: 'success',\n    text: '完成'\n  }\n}\n\n// columns type name\n\nconst columns = [{\n  title: '工单单号',\n  dataIndex: 'id',\n  //width: '10%',\n  align: 'center',\n  scopedSlots: { customRender: 'id' },\n  sorter: (a, b) => a.id > b.id,\n}, {\n  title: '被维修器件编号',\n  dataIndex: 'equipID',\n // width: '15%',\n  align: 'center',\n  scopedSlots: { customRender: 'equipID' },\n  sorter: (a, b) => a.equipID > b.equipID,\n}, {\n  title: '指定维修员编号',\n  dataIndex: 'repairerID',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: { customRender: 'repairerID' },\n  sorter: (a, b) => a.repairerID > b.repairerID,\n},{\n  title: '维修员姓名',\n  dataIndex: 'repairerName',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: { customRender: 'repairerName' },\n},{\n  title: '维修区域',\n  dataIndex: 'repairArea',\n  //width: '12%',\n  align: 'center',\n  scopedSlots: { customRender: 'repairArea' }\n},{\n  title: '调度员编号',\n  dataIndex: 'dispatcherID',\n  //width: '13%',\n  align: 'center',\n  scopedSlots: { customRender: 'dispatcherID' },\n  sorter: (a, b) => a.dispatcherID > b.dispatcherID,\n},{\n  title: '调度员姓名',\n  dataIndex: 'dispatcherName',\n  //width: '13%',\n  align: 'center',\n  scopedSlots: { customRender: 'dispatcherName' },\n}, {\n  title: '工单状态',\n  dataIndex: 'statue',\n  align: 'center',\n  //width: '12%',\n  filters: [{\n    text: '进行',\n    value: '0'\n  },{\n    text: '完成',\n    value: '1'\n  }],\n  onFilter: (value, record) => record.statue.indexOf(value) === 0,\n  scopedSlots: { customRender: 'statue' },\n},{\n  title: '维修结果图片',\n  align: 'center',\n  dataIndex: 'work_picture',\n  scopedSlots: { customRender: 'work_picture' }\n},{\n  titile: '操作',\n  align: 'center',\n  dataIndex: 'operation',\n  scopedSlots: { customRender: 'operation' }\n}]\n\n\n// sheets data\nconst wData = []\nconst wDataShow = []\nexport default {\n  name: 'workSheet',\n  inject: ['reload'],\n  components: {\n    PageView\n  },\n  data() {\n    this.cacheData = wData.map(item => ({ ...item }))\n    return {\n      attributeID: {\n        type: 'id',\n        cnType: '工单单号',\n        guide: '请输入单号'\n      },\n      attributeRepairer: {\n        type: 'repairerID',\n        cnType: '查询特定维修员的工单',\n        guide: '请输入维修员编号'\n      },\n      input: '',\n      input2: '',\n      input3: '',\n      input4:'',\n      input5:'',\n      wData,\n      wDataShow,\n      deleteInfo: '',\n      columns,\n      // information of add\n      isRouterAlive: true,\n      visible: false,\n      visible2: false,\n      src: \"\",\n      todelete:'',\n      form: this.$form.createForm(this)\n    }\n  },\n  watch:{\n    \n    input(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['id'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input2(pattern){\n        if(pattern == ''){\n            this.wDataShow = this.wData\n        }\n        else{\n            const option = {\n                keys: ['repairerID'],\n                threshold: 0.1\n            }\n            var fuse = new Fuse(this.wData,option)\n            this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input3(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['repairerName'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input4(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['dispatcherID'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input5(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['dispatcherName'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n      \n  },\n  \n  filters: {\n    statusFilter (type) {\n      return statusMap[type].text\n    },\n    statusTypeFilter (type) {\n      return statusMap[type].status\n    }\n  },\n  \n  methods: {\n    showImg (text) {\n        this.visible = true\n        this.src = text\n      },\n    handleHide () {\n      this.visible = false\n    },\n    //delete row\n    onClickDeleteRow () {\n      this.visible2 = false;\n      const newData = [...this.wDataShow]\n      console.log(newData)\n      const target = newData.filter(item => this.todelete === item.id)[0]\n      console.log(target)\n      if(target.statue === '0'){\n          this.$notification.open({\n          message: '删除失败',\n          description: '未完成的工单不可删除',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        return\n      }\n      \n      deleteWorkSheetRow({ id : target.id}).then((response) => {\n        this.deleteInfo = response.info\n        if(this.deleteInfo !== 'fail'){\n          this.wData = [...response.data]\n          this.wDataShow = this.wData\n        }\n        if(this.deleteInfo === 'ok'){\n          this.$notification.open({\n          message: '删除成功',\n          description: '本条工单记录删除成功',\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\n        });\n        }\n        else{\n          this.$notification.open({\n          message: '删除失败',\n          description: '本条工单记录删除失败',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        }\n      })\n      // to be complete\n    },\n    onClickRefresh(){\n      this.reload()\n    },\n    //modal dispear\n    onClickDelete (id) {\n      console.log(id)\n      this.todelete = id\n      this.visible2 = true;\n    },\n   \n  },\n  mounted () {\n    console.log(columns[5])\n    getWorkSheet().then((response) => {\n      console.log(...response.data)\n      this.wData = [...response.data]\n      this.wDataShow = this.wData\n    })\n    \n  }\n\n}\n",{"version":3,"sources":["workSheet.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"workSheet.vue","sourceRoot":"src/views/sheets","sourcesContent":["<template>\n  <page-view title=\"工单管理\">\n    <div>\n      <!-- input bar -->\n      <div>\n        <a-form class=\"ant-advanced-search-form\" :form=\"form\">\n          <a-row :gutter=\"24\">\n            <a-col :md=\"8\" :sm=\"24\">\n              <a-form-item label=\"查找工单\">\n                <a-input placeholder=\"请输入工单单号\" v-model=\"input\"/>\n              </a-form-item>\n            </a-col>\n          </a-row>\n          <a-row :gutter='24'>\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\n              <a-form-item label=\"根据编号查找维修员\">\n                <a-input placeholder=\"请输入维修员编号\" v-model=\"input2\"/>\n              </a-form-item>\n            </a-col>\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\n              <a-form-item label=\"根据姓名查找维修员\">\n                <a-input placeholder=\"请输入维修员姓名\" v-model=\"input3\"/>\n              </a-form-item>\n            </a-col>\n          </a-row>\n          <a-row :gutter='24'>\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\n              <a-form-item label=\"根据编号查找调度员\">\n                <a-input placeholder=\"请输入调度员编号\" v-model=\"input4\"/>\n              </a-form-item>\n            </a-col>\n            <a-col :md=\"8\" :sm=\"24\" :lg='10'>\n              <a-form-item label=\"根据姓名查找调度员\">\n                <a-input placeholder=\"请输入调度员姓名\" v-model=\"input5\"/>\n              </a-form-item>\n            </a-col>\n          </a-row>\n          <a-row>\n            <a-col :span=\"4\" style=\" textAlign: 'left';margin-bottom: 24px\">\n              <a-button\n                size=\"large\"\n                class=\"button\"\n                type=\"primary\"\n                @click=\"onClickRefresh\"\n              >刷新表单\n              </a-button>\n              <br>\n            </a-col>\n          </a-row>\n        </a-form>\n      </div>\n      <!-- input bar end -->\n      <!-- table -->\n      <a-card>\n        <a-table :columns=\"columns\" :dataSource=\"wDataShow\" rowKey='id' bordered>\n          <template\n            v-for=\"col in ['id','equipID', 'repairerID','repairerName','repairArea','dispatcherID','dispatcherName','statue']\"\n            :slot=\"col\"\n            slot-scope=\"text\"\n          >\n            <div :key=\"col\">\n              {{ text }}\n            </div>\n          </template>\n\n          <template slot='statue' slot-scope=\"text\">\n            <a-badge :status=\"text | statusTypeFilter\" :text=\"text | statusFilter\"/>\n          </template>\n          <template slot=\"work_picture\" slot-scope=\"text\">\n            <!--<div>\n              <a-avatar slot=\"avatar\" size=\"large\" shape=\"square\" :src=\"text\"/>\n            </div>-->\n            <div id=\"app\">\n              <div class=\"\">\n                <div\n                  class=\"pic\"\n                  @click=\"() => showImg(text)\"\n                >\n                  <a-avatar :src=\"text\"/>\n                </div>\n              </div>\n              <vue-easy-lightbox\n                :visible=\"visible\"\n                :imgs=\"src\"\n                @hide=\"handleHide\"\n              ></vue-easy-lightbox>\n            </div>\n          </template>\n          <template slot=\"operation\" slot-scope=\"text, record\">\n            <a-button\n              size=\"small\"\n              type=\"danger\"\n              :hidden='text'\n              @click=\"onClickDelete(record.id)\"\n            >删除\n            </a-button>\n            <a-modal\n              title=\"确认删除\"\n              v-model=\"visible2\"\n              @ok=\"onClickDeleteRow\"\n            >\n              <div class=\"modal\">\n                是否删除本条记录\n              </div>\n            </a-modal>\n          </template>\n        </a-table>\n      </a-card>\n      <!-- table end -->\n    </div>\n  </page-view>\n</template>\n\n\n<script>\nimport Fuse from 'fuse.js'\nimport Vue from 'vue'\nimport Lightbox from 'vue-easy-lightbox'\nimport { PageView } from '@/layouts'\n\n\nVue.use(Lightbox)\nimport { getWorkSheet, deleteWorkSheetRow } from '@/api/sheets'\n\n\nconst statusMap = {\n  0: {\n    status: 'processing',\n    text: '进行'\n  },\n  1: {\n    status: 'success',\n    text: '完成'\n  }\n}\n\n// columns type name\n\nconst columns = [{\n  title: '工单单号',\n  dataIndex: 'id',\n  //width: '10%',\n  align: 'center',\n  scopedSlots: { customRender: 'id' },\n  sorter: (a, b) => a.id > b.id,\n}, {\n  title: '被维修器件编号',\n  dataIndex: 'equipID',\n // width: '15%',\n  align: 'center',\n  scopedSlots: { customRender: 'equipID' },\n  sorter: (a, b) => a.equipID > b.equipID,\n}, {\n  title: '指定维修员编号',\n  dataIndex: 'repairerID',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: { customRender: 'repairerID' },\n  sorter: (a, b) => a.repairerID > b.repairerID,\n},{\n  title: '维修员姓名',\n  dataIndex: 'repairerName',\n  //width: '15%',\n  align: 'center',\n  scopedSlots: { customRender: 'repairerName' },\n},{\n  title: '维修区域',\n  dataIndex: 'repairArea',\n  //width: '12%',\n  align: 'center',\n  scopedSlots: { customRender: 'repairArea' }\n},{\n  title: '调度员编号',\n  dataIndex: 'dispatcherID',\n  //width: '13%',\n  align: 'center',\n  scopedSlots: { customRender: 'dispatcherID' },\n  sorter: (a, b) => a.dispatcherID > b.dispatcherID,\n},{\n  title: '调度员姓名',\n  dataIndex: 'dispatcherName',\n  //width: '13%',\n  align: 'center',\n  scopedSlots: { customRender: 'dispatcherName' },\n}, {\n  title: '工单状态',\n  dataIndex: 'statue',\n  align: 'center',\n  //width: '12%',\n  filters: [{\n    text: '进行',\n    value: '0'\n  },{\n    text: '完成',\n    value: '1'\n  }],\n  onFilter: (value, record) => record.statue.indexOf(value) === 0,\n  scopedSlots: { customRender: 'statue' },\n},{\n  title: '维修结果图片',\n  align: 'center',\n  dataIndex: 'work_picture',\n  scopedSlots: { customRender: 'work_picture' }\n},{\n  titile: '操作',\n  align: 'center',\n  dataIndex: 'operation',\n  scopedSlots: { customRender: 'operation' }\n}]\n\n\n// sheets data\nconst wData = []\nconst wDataShow = []\nexport default {\n  name: 'workSheet',\n  inject: ['reload'],\n  components: {\n    PageView\n  },\n  data() {\n    this.cacheData = wData.map(item => ({ ...item }))\n    return {\n      attributeID: {\n        type: 'id',\n        cnType: '工单单号',\n        guide: '请输入单号'\n      },\n      attributeRepairer: {\n        type: 'repairerID',\n        cnType: '查询特定维修员的工单',\n        guide: '请输入维修员编号'\n      },\n      input: '',\n      input2: '',\n      input3: '',\n      input4:'',\n      input5:'',\n      wData,\n      wDataShow,\n      deleteInfo: '',\n      columns,\n      // information of add\n      isRouterAlive: true,\n      visible: false,\n      visible2: false,\n      src: \"\",\n      todelete:'',\n      form: this.$form.createForm(this)\n    }\n  },\n  watch:{\n    \n    input(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['id'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input2(pattern){\n        if(pattern == ''){\n            this.wDataShow = this.wData\n        }\n        else{\n            const option = {\n                keys: ['repairerID'],\n                threshold: 0.1\n            }\n            var fuse = new Fuse(this.wData,option)\n            this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input3(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['repairerName'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input4(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['dispatcherID'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n    input5(pattern){\n          if(pattern == ''){\n              this.wDataShow = this.wData\n          }\n          else{\n              const option = {\n                  keys: ['dispatcherName'],\n                  threshold: 0.1\n              }\n              var fuse = new Fuse(this.wData,option)\n              this.wDataShow = fuse.search(pattern)\n          }\n      },\n      \n  },\n  \n  filters: {\n    statusFilter (type) {\n      return statusMap[type].text\n    },\n    statusTypeFilter (type) {\n      return statusMap[type].status\n    }\n  },\n  \n  methods: {\n    showImg (text) {\n        this.visible = true\n        this.src = text\n      },\n    handleHide () {\n      this.visible = false\n    },\n    //delete row\n    onClickDeleteRow () {\n      this.visible2 = false;\n      const newData = [...this.wDataShow]\n      console.log(newData)\n      const target = newData.filter(item => this.todelete === item.id)[0]\n      console.log(target)\n      if(target.statue === '0'){\n          this.$notification.open({\n          message: '删除失败',\n          description: '未完成的工单不可删除',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        return\n      }\n      \n      deleteWorkSheetRow({ id : target.id}).then((response) => {\n        this.deleteInfo = response.info\n        if(this.deleteInfo !== 'fail'){\n          this.wData = [...response.data]\n          this.wDataShow = this.wData\n        }\n        if(this.deleteInfo === 'ok'){\n          this.$notification.open({\n          message: '删除成功',\n          description: '本条工单记录删除成功',\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\n        });\n        }\n        else{\n          this.$notification.open({\n          message: '删除失败',\n          description: '本条工单记录删除失败',\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\n        });\n        }\n      })\n      // to be complete\n    },\n    onClickRefresh(){\n      this.reload()\n    },\n    //modal dispear\n    onClickDelete (id) {\n      console.log(id)\n      this.todelete = id\n      this.visible2 = true;\n    },\n   \n  },\n  mounted () {\n    console.log(columns[5])\n    getWorkSheet().then((response) => {\n      console.log(...response.data)\n      this.wData = [...response.data]\n      this.wDataShow = this.wData\n    })\n    \n  }\n\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import '~ant-design-vue/lib/style/themes/default.less';\n.button-group {\n  margin-bottom: 1rem;\n  .button {\n    margin-left: 0.5rem;\n    margin-left: 0.5rem;\n  }\n}\n</style>\n\n"]}]}