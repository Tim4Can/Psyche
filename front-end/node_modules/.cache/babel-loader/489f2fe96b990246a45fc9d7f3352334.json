{"remainingRequest":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\babel-loader\\lib\\index.js!D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\src\\views\\equipment\\EquipmentPreview.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\src\\views\\equipment\\EquipmentPreview.vue","mtime":1562869728000},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1573725483614},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1573722996621},{"path":"D:\\Documents\\GitHub\\Psyche\\front-end\\db-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1573725517685}],"contextDependencies":[],"result":["import _getIterator from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\db-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/get-iterator\";\nimport \"core-js/modules/es6.regexp.search\";\nimport _Object$assign from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\db-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/assign\";\nimport _toConsumableArray from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\db-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\db-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport _parseInt from \"D:\\\\Documents\\\\GitHub\\\\Psyche\\\\front-end\\\\db-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-int\";\nimport \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getEquipmentStoredList, getAllEquipmentType, addEquipmentStored } from '@/api/equipment';\nimport { getWarehouseName } from '@/api/accessory';\nimport { PageView } from '@/layouts';\nimport Fuse from 'fuse.js';\nimport Vue from 'vue';\nimport Lightbox from 'vue-easy-lightbox';\nimport moment from 'moment';\nimport ACol from 'ant-design-vue/es/grid/Col';\nVue.use(Lightbox);\n\nfunction showDate(time) {\n  var Times = new Array();\n  Times = time.split(' ');\n  date = Times[0];\n\n  for (i = 0; i < date.length; i++) {\n    if (date[i] === '-') {\n      date[i] = '.';\n    }\n  }\n}\n\nvar statusMap = {\n  0: {\n    status: 'success',\n    text: '全新'\n  },\n  1: {\n    status: 'error',\n    text: '报废'\n  }\n};\nvar columns = [{\n  title: '器材编号',\n  dataIndex: 'id',\n  align: 'center',\n  width: '12%',\n  scopedSlots: {\n    customRender: 'id'\n  },\n  sorter: function sorter(a, b) {\n    return _parseInt(a.id.toString().slice(2)) - _parseInt(b.id.toString().slice(2));\n  }\n}, {\n  title: '名称',\n  dataIndex: 'name',\n  align: 'center',\n  width: '10%',\n  scopedSlots: {\n    customRender: 'name'\n  }\n}, {\n  title: '图标',\n  dataIndex: 'icon',\n  align: 'center',\n  width: '7%',\n  scopedSlots: {\n    customRender: 'icon'\n  }\n}, {\n  title: '出厂时间',\n  dataIndex: 'productTime',\n  align: 'center',\n  width: '18%',\n  scopedSlots: {\n    customRender: 'productTime'\n  },\n  sorter: function sorter(a, b) {\n    return a.productTime > b.productTime;\n  }\n}, {\n  title: '状态',\n  dataIndex: 'status',\n  align: 'center',\n  width: '12%',\n  filters: [{\n    text: '全新',\n    value: '0'\n  }, {\n    text: '报废',\n    value: '1'\n  }],\n  onFilter: function onFilter(value, record) {\n    return record.status.indexOf(value) === 0;\n  },\n  scopedSlots: {\n    customRender: 'status'\n  }\n}, {\n  title: '型号编号',\n  dataIndex: 'model',\n  align: 'center',\n  width: '12%',\n  scopedSlots: {\n    customRender: 'model'\n  }\n}, {\n  title: '价格',\n  dataIndex: 'price',\n  align: 'center',\n  width: '8%',\n  scopedSlots: {\n    customRender: 'price'\n  },\n  sorter: function sorter(a, b) {\n    return a.price - b.price;\n  }\n}, {\n  title: '所在仓库',\n  dataIndex: 'warehouse',\n  align: 'center',\n  width: '14%',\n  scopedSlots: {\n    customRender: 'storehouse'\n  },\n  filters: [],\n  onFilter: function onFilter(value, record) {\n    return record.warehouse.indexOf(value) === 0;\n  }\n}]; // data\n\nvar inputID = '';\nvar eData = [];\nvar eDataShow = [];\nexport default {\n  inject: ['reload'],\n  name: 'EquipPreview',\n  components: {\n    ACol: ACol,\n    PageView: PageView\n  },\n  data: function data() {\n    this.cacheData = eData.map(function (item) {\n      return _objectSpread({}, item);\n    });\n    return {\n      labelCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 8\n        }\n      },\n      wrapperCol: {\n        xs: {\n          span: 24\n        },\n        sm: {\n          span: 15\n        }\n      },\n      equipmentData: {\n        id: '',\n        name: '',\n        productTime: '',\n        status: '',\n        model: '',\n        price: '',\n        count: '',\n        warehouse: ''\n      },\n      allWarehouse: [],\n      allEquipType: [],\n      visible: false,\n      visible2: false,\n      src: '',\n      eData: eData,\n      columns: columns,\n      eDataShow: eDataShow,\n      inputID: '',\n      inputTime: '',\n      advanced: false,\n      form: this.$form.createForm(this),\n      showAddForm: false,\n      newFormCount: 0,\n      newFormWarehouse: ''\n    };\n  },\n  computed: {\n    emptyInput: function emptyInput() {\n      if (this.equipmentData.id !== '' || this.equipmentData.name !== '' || this.equipmentData.model !== '' || this.equipmentData.price !== '' || this.equipmentData.count !== '' || this.equipmentData.warehouse !== '') {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  },\n  // watch for fuzzy search\n  methods: {\n    moment: moment,\n    onClickClearSelect: function onClickClearSelect() {\n      this.equipmentData.id = '';\n      this.equipmentData.name = '';\n      this.equipmentData.model = '';\n      this.equipmentData.price = '';\n      this.equipmentData.count = '';\n      this.equipmentData.warehouse = '';\n    },\n    onClickSubmit: function onClickSubmit() {\n      this.onClickClearSelect();\n    },\n    handleChange: function handleChange(value, key, column) {\n      var newData = _toConsumableArray(this.eData);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        target[column] = value;\n        this.eData = newData;\n      }\n    },\n    edit: function edit(key) {\n      var newData = _toConsumableArray(this.eData);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        target.editable = true;\n        this.eData = newData;\n      }\n    },\n    save: function save(key) {\n      var newData = _toConsumableArray(this.eData);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        delete target.editable;\n        this.eData = newData;\n        this.cacheData = newData.map(function (item) {\n          return _objectSpread({}, item);\n        });\n      }\n    },\n    cancel: function cancel(key) {\n      var newData = _toConsumableArray(this.eData);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        _Object$assign(target, this.cacheData.filter(function (item) {\n          return key === item.key;\n        })[0]);\n\n        delete target.editable;\n        this.eData = newData;\n      }\n    },\n    toggleAdvanced: function toggleAdvanced() {\n      this.advanced = !this.advanced;\n    },\n    addEquipment: function addEquipment() {\n      this.showAddForm = true;\n    },\n    handleSubmit: function handleSubmit(e) {\n      var _this = this;\n\n      var h = this.$createElement;\n      e.preventDefault();\n      this.form.validateFields(function (err, value) {\n        if (!err) {\n          value['productTime'] = value['productTime'].format('YYYY.MM.DD');\n          addEquipmentStored(value).then(function (response) {\n            _this.eData = _toConsumableArray(response.data);\n            _this.eDataShow = _this.eData;\n\n            _this.$notification.open({\n              message: '添加成功',\n              description: '请继续您的操作',\n              icon: h(\"a-icon\", {\n                \"attrs\": {\n                  \"type\": \"exclamation-circle\"\n                },\n                \"style\": \"color: blue\"\n              })\n            });\n          }).catch(function (err) {\n            _this.$notification.open({\n              message: '添加失败',\n              description: '请查看控制台信息',\n              icon: h(\"a-icon\", {\n                \"attrs\": {\n                  \"type\": \"exclamation-circle\"\n                },\n                \"style\": \"color: #108ee9\"\n              })\n            });\n\n            console.log(err);\n          });\n        }\n      });\n      this.showAddForm = false;\n    },\n    cancelAddForm: function cancelAddForm() {\n      this.showAddForm = false;\n    },\n    showImg: function showImg(text) {\n      this.visible = true;\n      this.src = text;\n    },\n    handleHide: function handleHide() {\n      this.visible = false;\n    }\n  },\n  filters: {\n    statusFilter: function statusFilter(type) {\n      return statusMap[type].text;\n    },\n    statusTypeFilter: function statusTypeFilter(type) {\n      return statusMap[type].status;\n    }\n  },\n  watch: {\n    inputID: function inputID(pattern) {\n      if (pattern == '') {\n        this.eDataShow = this.eData;\n      } else {\n        var option = {\n          keys: ['id'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.eData, option);\n        this.eDataShow = fuse.search(pattern);\n      }\n    },\n    inputTime: function inputTime(pattern) {\n      if (pattern == '') {\n        this.eDataShow = this.eData;\n      } else {\n        var option = {\n          keys: ['productTime'],\n          threshold: 0.1\n        };\n        var fuse = new Fuse(this.eData, option);\n        this.eDataShow = fuse.search(pattern);\n      }\n    }\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    getEquipmentStoredList().then(function (response) {\n      _this2.eData = _toConsumableArray(response.data);\n      _this2.eDataShow = _this2.eData;\n    }), getWarehouseName().then(function (response) {\n      _this2.allWarehouse = _toConsumableArray(response.data);\n      _this2.columns[7].filters = [];\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = _getIterator(_this2.allWarehouse), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var val = _step.value;\n          var temp = {\n            text: val,\n            value: val\n          };\n\n          _this2.columns[7].filters.push(temp);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }), getAllEquipmentType().then(function (response) {\n      _this2.allEquipType = _toConsumableArray(response.data);\n    });\n  }\n};",{"version":3,"sources":["EquipmentPreview.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <page-view title=\"仓储器材\">\n    <div>\n      <a-card :bordered=\"false\">\n        <a-form class=\"ant-advanced-search-form\" :form=\"form\" inline>\n          <a-row :gutter=\"24\">\n            <a-col :md=\"6\" :sm=\"24\">\n              <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"器材编号：\">\n                <a-input placeholder=\"请输入器材编号\" v-model=\"inputID\" />\n              </a-form-item>\n            </a-col>\n            <a-col :md=\"6\" :sm=\"24\">\n              <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"出厂时间：\">\n                <a-input placeholder=\"请输入出厂时间\" v-model=\"inputTime\" />\n              </a-form-item>\n            </a-col>\n            <a-col style=\"text-align: right\">\n              <a-button style=\"margin-right: 1rem\" @click=\"reload()\" type=\"primary\" icon=\"reload\">刷新</a-button>\n              <a-button @click=\"addEquipment\" type=\"primary\" icon=\"plus\">添加器材</a-button>\n            </a-col>\n          </a-row>\n        </a-form>\n        <br />\n        <a-table :columns=\"columns\" :dataSource=\"eDataShow\" rowKey=\"id\" bordered>\n          <template v-for=\"col in ['id']\" :slot=\"col\" slot-scope=\"text\">{{text}}</template>\n          <template slot=\"status\" slot-scope=\"text\">\n            <a-badge :status=\"text | statusTypeFilter\" :text=\"text | statusFilter\" />\n          </template>\n          <template slot=\"price\" slot-scope=\"text\">{{\"￥\" + text}}</template>\n          <template slot=\"icon\" slot-scope=\"text\">\n            <div id=\"app\">\n              <div class>\n                <div class=\"pic\" @click=\"() => showImg(text)\">\n                  <a-avatar :src=\"text\" />\n                </div>\n              </div>\n              <vue-easy-lightbox :visible=\"visible\" :imgs=\"src\" @hide=\"handleHide\"></vue-easy-lightbox>\n            </div>\n          </template>\n        </a-table>\n        <a-modal v-model=\"showAddForm\" footer>\n          <a-form title=\"添加器材\" @submit=\"handleSubmit\" :form=\"form\">\n            <a-form-item :wrapperCol=\"{ span: 24 }\" style=\"text-align: center\">\n              <h3>新建器材</h3>\n            </a-form-item>\n            <a-form-item\n              label=\"名称\"\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\n            >\n              <a-select\n                v-decorator=\"[\n          'name',\n          {rules: [{ required: true, message: '请选择器材名称' }]}\n        ]\"\n                placeholder=\"请选择器材名称\"\n              >\n                <a-select-option\n                  v-for=\"(item,index) in this.allEquipType\"\n                  :key=\"index\"\n                  :value=\"item\"\n                >{{item}}</a-select-option>\n              </a-select>\n            </a-form-item>\n            <a-form-item\n              label=\"出厂日期\"\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\n            >\n              <a-date-picker\n                name=\"productTime\"\n                style=\"width: 100%\"\n                format=\"YYYY.MM.DD\"\n                v-decorator=\"[\n            'productTime',\n            {rules: [{ required: true, message: '请选择出厂日期' }]}\n          ]\"\n              />\n            </a-form-item>\n            <a-form-item\n              label=\"器材型号\"\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\n            >\n              <a-input\n                v-decorator=\"[\n            'model',\n            {rules: [{ required: true, message: '请输入器材型号' }]}\n          ]\"\n                name=\"model\"\n                placeholder=\"输入器材型号\"\n              />\n            </a-form-item>\n            <a-form-item\n              label=\"仓库\"\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\n            >\n              <a-select\n                v-decorator=\"[\n          'warehouse',\n          {rules: [{ required: true, message: '请选择所属仓库' }]}\n        ]\"\n                placeholder=\"请选择所属仓库\"\n              >\n                <a-select-option\n                  v-for=\"(item,index) in this.allWarehouse\"\n                  :key=\"index\"\n                  :value=\"item\"\n                >{{item}}</a-select-option>\n              </a-select>\n            </a-form-item>\n\n            <a-form-item :wrapperCol=\"{ span: 24 }\" style=\"text-align: center\">\n              <a-button htmlType=\"submit\" type=\"primary\">提交</a-button>\n              <a-button style=\"margin-left: 8px\" @click=\"cancelAddForm\">取消</a-button>\n            </a-form-item>\n          </a-form>\n        </a-modal>\n      </a-card>\n    </div>\n  </page-view>\n</template>\n\n<script>\nimport { getEquipmentStoredList, getAllEquipmentType, addEquipmentStored } from '@/api/equipment'\nimport { getWarehouseName } from '@/api/accessory'\nimport { PageView } from '@/layouts'\nimport Fuse from 'fuse.js'\nimport Vue from 'vue'\nimport Lightbox from 'vue-easy-lightbox'\nimport moment from 'moment'\nimport ACol from 'ant-design-vue/es/grid/Col'\nVue.use(Lightbox)\n\nfunction showDate(time) {\n  var Times = new Array()\n  Times = time.split(' ')\n  date = Times[0]\n  for (i = 0; i < date.length; i++) {\n    if (date[i] === '-') {\n      date[i] = '.'\n    }\n  }\n}\nconst statusMap = {\n  0: {\n    status: 'success',\n    text: '全新'\n  },\n  1: {\n    status: 'error',\n    text: '报废'\n  }\n}\nconst columns = [\n  {\n    title: '器材编号',\n    dataIndex: 'id',\n    align: 'center',\n    width: '12%',\n    scopedSlots: { customRender: 'id' },\n    sorter: (a, b) => parseInt(a.id.toString().slice(2)) - parseInt(b.id.toString().slice(2))\n  },\n  {\n    title: '名称',\n    dataIndex: 'name',\n    align: 'center',\n    width: '10%',\n    scopedSlots: { customRender: 'name' }\n  },\n  {\n    title: '图标',\n    dataIndex: 'icon',\n    align: 'center',\n    width: '7%',\n    scopedSlots: { customRender: 'icon' }\n  },\n  {\n    title: '出厂时间',\n    dataIndex: 'productTime',\n    align: 'center',\n    width: '18%',\n    scopedSlots: { customRender: 'productTime' },\n    sorter: (a, b) => a.productTime > b.productTime\n  },\n  {\n    title: '状态',\n    dataIndex: 'status',\n    align: 'center',\n    width: '12%',\n    filters: [\n      {\n        text: '全新',\n        value: '0'\n      },\n      {\n        text: '报废',\n        value: '1'\n      }\n    ],\n    onFilter: (value, record) => record.status.indexOf(value) === 0,\n    scopedSlots: { customRender: 'status' }\n  },\n  {\n    title: '型号编号',\n    dataIndex: 'model',\n    align: 'center',\n    width: '12%',\n    scopedSlots: { customRender: 'model' }\n  },\n  {\n    title: '价格',\n    dataIndex: 'price',\n    align: 'center',\n    width: '8%',\n    scopedSlots: { customRender: 'price' },\n    sorter: (a, b) => a.price - b.price\n  },\n  {\n    title: '所在仓库',\n    dataIndex: 'warehouse',\n    align: 'center',\n    width: '14%',\n    scopedSlots: { customRender: 'storehouse' },\n    filters: [],\n    onFilter: (value, record) => record.warehouse.indexOf(value) === 0\n  }\n]\n// data\nlet inputID = ''\nconst eData = []\nconst eDataShow = []\nexport default {\n  inject: ['reload'],\n  name: 'EquipPreview',\n  components: {\n    ACol,\n    PageView\n  },\n  data() {\n    this.cacheData = eData.map(item => ({ ...item }))\n    return {\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 8 }\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 15 }\n      },\n      equipmentData: {\n        id: '',\n        name: '',\n        productTime: '',\n        status: '',\n        model: '',\n        price: '',\n        count: '',\n        warehouse: ''\n      },\n      allWarehouse: [],\n      allEquipType: [],\n      visible: false,\n      visible2: false,\n      src: '',\n      eData,\n      columns,\n      eDataShow,\n      inputID: '',\n      inputTime: '',\n      advanced: false,\n      form: this.$form.createForm(this),\n      showAddForm: false,\n      newFormCount: 0,\n      newFormWarehouse: ''\n    }\n  },\n  computed: {\n    emptyInput() {\n      if (\n        this.equipmentData.id !== '' ||\n        this.equipmentData.name !== '' ||\n        this.equipmentData.model !== '' ||\n        this.equipmentData.price !== '' ||\n        this.equipmentData.count !== '' ||\n        this.equipmentData.warehouse !== ''\n      ) {\n        return false\n      } else {\n        return true\n      }\n    }\n  },\n  // watch for fuzzy search\n  methods: {\n    moment,\n    onClickClearSelect() {\n      this.equipmentData.id = ''\n      this.equipmentData.name = ''\n      this.equipmentData.model = ''\n      this.equipmentData.price = ''\n      this.equipmentData.count = ''\n      this.equipmentData.warehouse = ''\n    },\n    onClickSubmit() {\n      this.onClickClearSelect()\n    },\n    handleChange(value, key, column) {\n      const newData = [...this.eData]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target[column] = value\n        this.eData = newData\n      }\n    },\n    edit(key) {\n      const newData = [...this.eData]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target.editable = true\n        this.eData = newData\n      }\n    },\n    save(key) {\n      const newData = [...this.eData]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        delete target.editable\n        this.eData = newData\n        this.cacheData = newData.map(item => ({ ...item }))\n      }\n    },\n    cancel(key) {\n      const newData = [...this.eData]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        Object.assign(target, this.cacheData.filter(item => key === item.key)[0])\n        delete target.editable\n        this.eData = newData\n      }\n    },\n    toggleAdvanced() {\n      this.advanced = !this.advanced\n    },\n    addEquipment() {\n      this.showAddForm = true\n    },\n    handleSubmit(e) {\n      e.preventDefault()\n      this.form.validateFields((err, value) => {\n        if (!err) {\n          value['productTime'] = value['productTime'].format('YYYY.MM.DD')\n          addEquipmentStored(value)\n            .then(response => {\n              this.eData = [...response.data]\n              this.eDataShow = this.eData\n              this.$notification.open({\n                message: '添加成功',\n                description: '请继续您的操作',\n                icon: <a-icon type=\"exclamation-circle\" style=\"color: blue\" />\n              })\n            })\n            .catch(err => {\n              this.$notification.open({\n                message: '添加失败',\n                description: '请查看控制台信息',\n                icon: <a-icon type=\"exclamation-circle\" style=\"color: #108ee9\" />\n              })\n              console.log(err)\n            })\n        }\n      })\n      this.showAddForm = false\n    },\n    cancelAddForm() {\n      this.showAddForm = false\n    },\n    showImg(text) {\n      this.visible = true\n      this.src = text\n    },\n    handleHide() {\n      this.visible = false\n    }\n  },\n  filters: {\n    statusFilter(type) {\n      return statusMap[type].text\n    },\n    statusTypeFilter(type) {\n      return statusMap[type].status\n    }\n  },\n  watch: {\n    inputID(pattern) {\n      if (pattern == '') {\n        this.eDataShow = this.eData\n      } else {\n        const option = {\n          keys: ['id'],\n          threshold: 0.1\n        }\n        var fuse = new Fuse(this.eData, option)\n        this.eDataShow = fuse.search(pattern)\n      }\n    },\n    inputTime(pattern) {\n      if (pattern == '') {\n        this.eDataShow = this.eData\n      } else {\n        const option = {\n          keys: ['productTime'],\n          threshold: 0.1\n        }\n        var fuse = new Fuse(this.eData, option)\n        this.eDataShow = fuse.search(pattern)\n      }\n    }\n  },\n  mounted() {\n    getEquipmentStoredList().then(response => {\n      this.eData = [...response.data]\n      this.eDataShow = this.eData\n    }),\n      getWarehouseName().then(response => {\n        this.allWarehouse = [...response.data]\n        this.columns[7].filters = []\n        for (let val of this.allWarehouse) {\n          let temp = {\n            text: val,\n            value: val\n          }\n          this.columns[7].filters.push(temp)\n        }\n      }),\n      getAllEquipmentType().then(response => {\n        this.allEquipType = [...response.data]\n      })\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import '~ant-design-vue/lib/style/themes/default.less';\n.button-group {\n  margin-bottom: 1rem;\n  .button {\n    margin-left: 0.5rem;\n    margin-left: 0.5rem;\n  }\n}\n.ant-form-inline .ant-form-item {\n  display: inline-block;\n  margin-right: 0;\n}\n</style>"],"sourceRoot":"src/views/equipment"}]}